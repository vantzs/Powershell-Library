# Errata - Chapter 3
##### As of :  10/8/2017 8:34:45 PM 
##### Author: <tfl@psp.co.uk> 
##


## General 
Nothing new to add

### Page 92 - Step 2

This step should read:

    Get-WindowsFeature |
        Where-Object Installed


### Page 92 - Step 3

This step should read:

    $WSUSContentDir = 'C:\WSUS'
    If (-Not (Get-ChildItem -Path $WSUSContentDir -ErrorAction SilentlyContinue))
        {New-Item -Path $WSUSContentDir -ItemType Directory}


 
### Page 92 - Step 4

This step should read:

    & "$env:ProgramFiles\Update Services\Tools\WsusUtil.exe"  `
        Postinstall CONTENT_DIR=$WSUSContentDir
Also- this step can take quite a while after the message 'Post install is starting' is 
first displayed.

This step generates a message that notes the generated log file - this is needed for step 5


### Page 92 - Step 4

In this step you look at the log file generated by `WsusUtil`. The log file is generated
in the `$env:TEMP` folder and varies. Adjust this step to use the log file generated by step 4.

### Page 94 - Step 13

In the published book, step 14 started:

    $WSUSSubscription.StartSynchronizationForCategoryOnly()

This did not seem to work so the step was changed (and now works, so as to read:

    $WSUSSubscription.StartSynchronization()
    Do {
         Write-Output $WSUSSubscription.GetSynchronizationProgress()
         Start-Sleep -Seconds 5
       } 
    While ($WSUSSubscription.GetSynchronizationStatus() -ne `
              'NotProcessing')

#### Page 101-102 - Step 7

This step (over two pages!) should now read:
    
    $WSUSServer = Get-WsusServer
    $WSUSSubscription = $WSUSServer.GetSubscription()
    # Start synchronizing available updates
    $WSUSSubscription.StartSynchronization()
    $IntervalSeconds = 5
    # Wait for synchronizing to start
    Do {
         Write-Output $WSUSSubscription.GetSynchronizationProgress()
         Start-Sleep -Seconds $IntervalSeconds
    }
    While ($WSUSSubscription.GetSynchronizationStatus() -eq `
        'NotProcessing')
    #wait for all phases of process to end
    Do {
         Write-Ou#tput $WSUSSubscription.GetSynchronizationProgress()
         Start-Sleep -Seconds $IntervalSeconds
    }
    Until ($WSUSSubscription.GetSynchronizationStatus() -eq `
        'NotProcessing')

#### Page 106 - Getting Ready

If you add the RSAT feature on `WSUS1`, you may need to reboot your system.


#### Page 107 - Step 4

If you update Windows Server, change this step to read:

    $AutoUpdates = New-Object -ComObject "Microsoft.Update.AutoUpdate"
    $AutoUpdates.DetectNow()



#### Page 110 - Getting ready

If you have completed all the previous recipes, then it can take some time before the WSUS GPO object is applied and the system's Windows Update client registers with the WSUS server. If you are testing this recipe, you need to wait until `Get-WsusComputer` 'finds' DC1.  


### Page 110 - Step 3

This step should read:

    $DCGroup = $WSUSServer.GetComputerTargetGroups() |
        Where-Object -Name -eq 'Domain Controllers'
    Get-WsusComputer |
        Where-Object ComputerTargetGroupIDs -Contains $DCGroup.id


### Page 112 - Step 1

This step should read:

    $WSUSServer = Get-WsusServer
    $ApprovalRule = 
        $WSUSServer.CreateInstallApprovalRule('Critical Updates')

### Page 112 - Step 2

This step should read:

    $type = 'Microsoft.UpdateServices.Administration.' + `
            'AutomaticUpdateApprovalDeadline'
    $RuleDeadLine = New-Object -Typename $type
    $RuleDeadLine.DayOffset = 3
    $RuleDeadLine.MinutesAfterMidnight = 180
    $ApprovalRule.Deadline = $RuleDeadLine

### Page 112 - Step 3

This step should read:

    $UpdateClassification = $ApprovalRule.GetUpdateClassifications()
    $UpdateClassification.Add(($WSUSServer.GetUpdateClassifications() |
        Where-Object -Property Title -eq 'Critical Updates'))
    $UpdateClassification.Add(($WSUSServer.GetUpdateClassifications() |
        Where-Object -Property Title -eq 'Definition Updates'))
    $ApprovalRule.SetUpdateClassifications($UpdateClassification)

### Page Page 113 - step 4

This step should read:
    
    $TargetGroups = New-Object `
        Microsoft.UpdateServices.Administration.ComputerTargetGroupCollection
    $TargetGroups.Add(($WSUSServer.GetComputerTargetGroups() |
        Where-Object -Property Name -eq "Domain Controllers"))
    $ApprovalRule.SetComputerTargetGroups($TargetGroups)
    






    


